<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"> <!-- NOTE: Standard UTF-8 encoding -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0"> <!-- NOTE: Makes page responsive -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"> <!-- NOTE: Bootstrap CSS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script> <!-- NOTE: Bootstrap JS -->
  <title>Supermarket App</title> <!-- NOTE: Browser tab title -->
</head>
<body>

  <%- include('partials/adminNav', { active: 'inventory' }) %> 
  <!-- NOTE: Loads admin navigation bar and highlights "inventory" -->

  <!-- Main content -->
  <main class="main-content py-4"> <!-- NOTE: Main page spacing -->
    <div class="container">
      <h2 class="text-center mb-4">Update Product</h2> <!-- NOTE: Page title -->
      
      <% if (product) { %> <!-- NOTE: If product exists, show form -->
        <form action="/updateProduct/<%= product.id %>" method="POST" enctype="multipart/form-data" class="mx-auto" style="max-width: 500px;">
          <!-- NOTE: Form posts to /updateProduct/:id -->
          <!-- NOTE: enctype multipart/form-data required for file upload -->

          <div class="mb-3">
            <label for="name" class="form-label">Product Name</label>
            <input type="text" class="form-control" id="name" name="name" value="<%= product.productName %>" required>
            <!-- NOTE: Prefilled product name -->
          </div>

          <div class="mb-3">
            <label for="quantity" class="form-label">Quantity</label>
            <input type="number" class="form-control" id="quantity" name="quantity" min="0" step="1" value="<%= product.quantity %>" required>
            <!-- NOTE: Prefilled quantity -->
          </div>

          <div class="mb-3">
            <label for="price" class="form-label">Price</label>
            <input type="number" class="form-control" id="price" name="price" min="0" step="0.01" value="<%= product.price %>" required>
            <!-- NOTE: Prefilled price -->
          </div>

          <div class="mb-3">
            <label class="form-label">Current Image</label>
            <input type="text" class="form-control" name="currentImage" value="<%= product.image %>" readonly>
            <!-- NOTE: Shows image filename (readonly) -->
            <img src="/images/<%= product.image %>" class="img-thumbnail mt-2" style="width: 150px;">
            <!-- NOTE: Preview of existing image -->
          </div>

          <div class="mb-4">
            <label for="image" class="form-label">Upload New Image</label>
            <input class="form-control" type="file" id="image" name="image" accept="image/*">
            <!-- NOTE: Optional: upload replacement image -->
          </div>

          <div class="d-grid gap-2 mb-4">
            <button type="submit" class="btn btn-primary">Update Product</button> <!-- NOTE: Submit update -->
            <a href="/inventory" class="btn btn-secondary">Back to Inventory</a> <!-- NOTE: Return to inventory list -->
          </div>

        </form>

      <% } else { %> <!-- NOTE: If no product found -->
        <p class="text-center mb-4">No product found.</p>
      <% } %>

    </div>
  </main>

<style>
  html { scroll-behavior: smooth; } /* NOTE: Smooth scrolling effect */

  /* Ensure full height layout */
  body { 
    min-height: 100vh;           /* NOTE: Makes the body fill the screen height */
    display: flex; 
    flex-direction: column;      /* NOTE: Allows footer to stay bottom */
  }

  /* This FIXES the footer covering content */
  main {
    flex: 1 0 auto;               /* NOTE: Allows main to expand */
    padding-bottom: 140px;        /* NOTE: Extra space so footer doesn't overlap */
  }

  footer { 
    flex-shrink: 0;               /* NOTE: Footer stays at bottom */
    margin-top: auto; 
  }

  .app-footer { 
    background-color: #0b2131;    /* NOTE: Dark-themed footer */
    color: #e6edf3; 
  }

  .app-footer a { 
    color: #e6edf3;               /* NOTE: Footer link color */
    text-decoration: none; 
  }

  .app-footer a:hover { 
    text-decoration: underline;   /* NOTE: Hover effect */
  }

  .app-footer-gradient { 
    height: 4px; 
    background: linear-gradient(
      90deg,
      var(--bs-primary, #0d6efd),
      var(--bs-info, #0dcaf0),
      var(--bs-success, #198754),
      var(--bs-warning, #ffc107),
      var(--bs-danger, #dc3545)
    );  /* NOTE: Color gradient bar */
  }

  .app-footer-inner { 
    font-size: .95rem;            /* NOTE: Footer text size */
  }
</style>

<%- include('partials/footer') %> <!-- NOTE: Render footer partial -->

</body>
</html>
